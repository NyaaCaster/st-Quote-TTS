# SillyTavern Quote TTS

这是一个为 [SillyTavern](https://github.com/SillyTavern/SillyTavern) 设计的扩展插件。

它的主要功能是自动识别对话中被引号包裹的文本（支持中文、英文、日文引号），并在其后添加一个独立的 **播放按钮**。点击按钮即可调用配置好的 `openai-edge-tts` API 朗读该段文本。

此外，该插件支持为不同的角色分配独立的音色。

## ✨ 功能特性

*   **多语言引号支持**：自动识别并提取以下引号内的文本：
    *   英文引号：`""`
    *   中文引号：`“”` 和 `‘’`
    *   日文引号：`「」` 和 `『』`
*   **角色音色绑定**：可以扫描当前的对话角色，并为每个角色单独指定音色。
*   **UI 集成**：无缝集成到 SillyTavern 的聊天界面，不影响原有排版。

## 📦 安装方法

本扩展支持通过 SillyTavern 内置的扩展安装器进行安装。

1.  打开 SillyTavern。
2.  点击顶部的 **扩展 (Extensions)** 图标（积木形状）。
3.  点击 **安装扩展 (Install Extension)** 按钮。
4.  在 "从 URL 安装 (Install from URL)" 输入框中，粘贴本仓库地址：
    ```
    https://github.com/NyaaCaster/st-Quote-TTS
    ```
5.  点击 **保存 (Save)** 或 **安装 (Install)**。
6.  安装完成后，**刷新页面**或重启 SillyTavern 以加载扩展。

## ⚙️ 配置说明

安装并刷新页面后，请按照以下步骤配置：

### 1. 基础 API 配置
1.  打开 **扩展 (Extensions)** 菜单。
2.  找到 **Quote TTS** 设置面板。

### 2. 角色音色绑定
为了让不同的角色拥有不同的声音，您需要手动绑定音色：

1.  在设置面板中，点击 **"🔄 读取当前角色列表"** 按钮。
2.  下方会出现当前会话及卡片列表中的角色名。
3.  使用下拉菜单为每个角色选择音色，支持以下 Edge-TTS 音色：
    *   `zh-CN-XiaoxiaoNeural` (女声，温暖)
    *   `zh-CN-XiaoyiNeural` (女声，气泡)
    *   `zh-CN-YunxiNeural` (男声，沉稳)
    *   `zh-CN-YunyangNeural` (男声，专业)
4.  修改后设置会自动保存。

## 📖 使用指南

1.  进入任意对话。
2.  当角色回复的内容包含引号时（例如：`她说：“你好，今天天气真不错。”`），扩展会自动在引号后渲染一个 🔊 播放按钮。
3.  点击该按钮。
4.  按钮图标会变为 ⏳ (加载中)，待音频生成完毕后即自动播放。

## ❓ 常见问题

**Q: 点击按钮后一直在转圈 (⏳)，没有声音？**
A: 请检查：
1.  您的 API URL 是否可以从浏览器访问。
2.  SillyTavern 的控制台 (F12) 是否有报错信息（如跨域 CORS 错误或 404/500 错误）。
3.  确保您的后端服务支持 `tts-1-hd` 模型参数。

**Q: 为什么新发的消息没有按钮？**
A: 扩展会自动监听新消息。如果网络卡顿导致 DOM 渲染延迟，尝试刷新页面，按钮通常会重新出现。

## 📄 License
MIT
